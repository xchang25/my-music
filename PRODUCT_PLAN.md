# 音乐网站产品完善计划（移动端优先）

## 1. 市场对标结论（用于交互基线）

### A. Spotify Web Player（对标点）
- 强调：播放控制一致性、队列可见且可操作、跨页面持续播放。
- 参考：
  - https://open.spotify.com/
  - https://support.spotify.com/us/article/queue/
  - https://support.spotify.com/us/article/lyrics/

### B. Apple Music Web（对标点）
- 强调：歌词沉浸、播放页视觉统一、浏览/搜索/资料库切换清晰。
- 参考：
  - https://music.apple.com/
  - https://support.apple.com/guide/music-web/welcome/web

### C. 主流中文音乐平台（QQ/网易云）通用模式（UI 观察抽象）
- 强调：移动端底部导航、播放控件稳定位置、队列与歌词均可快速触达。
- 设计原则：控制区域固定、主要动作不超过 1 次点击、列表具备滚动与状态反馈。

## 2. 产品目标（当前站点）

1) 搜索成功率与可恢复性：避免“无结果即失败”的体验。
2) 播放器沉浸逻辑：非操作状态自动收敛，交互时即时展开。
3) 队列成为“可管理对象”：可播放、可移除、可清空、可感知数量。
4) 全屏歌词具备“动态感”：背景缓动、行级动效、当前行聚焦。
5) 手机网页端优先：底部导航 + 触控友好 + 低误触。

## 3. 分阶段实施路线（自动化执行）

### Phase 1（已落地）
- 搜索：单平台失败与空结果恢复策略（包括自动回退/切换逻辑）。
- 播放器：进度区悬停唤醒 + 自动沉浸缩小。
- 队列：数量显示、单首移除、一键清空。
- 歌词：全屏背景动效、行进入动画、当前行高亮增强。
- 移动端：增加底部导航并与侧边菜单联动。

### Phase 2（下一步执行）
- 搜索：增加“热门关键词建议 + 最近搜索”。
- 队列：增加“上移/下移”排序。
- 播放器：增加快捷键（空格、左右键、M 静音）。
- 歌词：增加“逐词高亮强度”和“歌词字体大小切换”。
- 移动端：增加手势（上滑展开播放器、下滑收起）。

### Phase 3（稳定性与体验封顶）
- 加入骨架屏与空态插画。
- 加入 API 可观测性（请求耗时、错误分布、命中率）。
- 统一按钮尺寸栅格与动画时序规范。
- 增加端到端回归脚本（关键路径：登录->搜索->播放->歌词->队列）。

## 4. 验收标准（每次迭代必须满足）

1) 搜索：三平台任一至少可稳定返回可播放歌曲；失败要有明确提示文案。
2) 播放器：桌面端 2-3 秒无交互自动收敛，恢复延迟 < 150ms。
3) 队列：新增/播放/移除/清空均可在 UI 与状态中同步。
4) 歌词：全屏打开时背景和歌词滚动无明显卡顿。
5) 移动端：导航、播放按钮、进度拖动都可单手触达。

## 5. 自动化质量门禁

每次改动后固定执行：

```bash
node --check app.js
node --check api/search.js
node --check api/toplists.js
node --check api/toplist.js
node --check api/_utils.js
node --check api/_security.js
```

若语法检查失败，必须在本轮修复后再进入下一阶段。

